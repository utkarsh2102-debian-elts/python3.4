Index: python3.4-3.4.2/Lib/tarfile.py
===================================================================
--- python3.4-3.4.2.orig/Lib/tarfile.py	2020-09-29 15:06:52.830686021 +0200
+++ python3.4-3.4.2/Lib/tarfile.py	2020-09-29 15:06:52.822685628 +0200
@@ -1221,6 +1221,8 @@
 
             length, keyword = match.groups()
             length = int(length)
+            if length == 0:
+                raise InvalidHeaderError("invalid header")
             value = buf[match.end(2) + 1:match.start(1) + length - 1]
 
             # Normally, we could just use "utf-8" as the encoding and "strict"
Index: python3.4-3.4.2/Lib/test/test_tarfile.py
===================================================================
--- python3.4-3.4.2.orig/Lib/test/test_tarfile.py	2020-09-29 15:06:52.830686021 +0200
+++ python3.4-3.4.2/Lib/test/test_tarfile.py	2020-09-29 15:06:52.826685825 +0200
@@ -350,6 +350,13 @@
                 tar.close()
 
 
+    def test_length_zero_header(self):
+        # bpo-39017 (CVE-2019-20907): reading a zero-length header should fail
+        # with an exception
+        with self.assertRaisesRegex(tarfile.ReadError, "file could not be opened successfully"):
+            with tarfile.open(support.findfile('recursion.tar')) as tar:
+                pass
+
 class MiscReadTestBase(CommonReadTest):
     def requires_name_attribute(self):
         pass
Index: python3.4-3.4.2/Misc/NEWS.d/next/Library/2020-07-12-22-16-58.bpo-39017.x3Cg-9.rst
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ python3.4-3.4.2/Misc/NEWS.d/next/Library/2020-07-12-22-16-58.bpo-39017.x3Cg-9.rst	2020-09-29 15:06:52.826685825 +0200
@@ -0,0 +1 @@
+Avoid infinite loop when reading specially crafted TAR files using the tarfile module (CVE-2019-20907).
